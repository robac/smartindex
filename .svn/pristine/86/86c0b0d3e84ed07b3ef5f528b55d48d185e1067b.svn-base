<?php

require_once dirname(__FILE__).'/../inc.php';
INC_dokuwikiCore();
INC_defineBasics();


global $conf;

$res = "";
$config = new SmartIndexConf();
$config->depth = 2;
$config->namespace = $_GET['namespace'];
$config->checkHandle();
$config->checkRender();
if (!is_null($config->error)) {
    $res .= "<div class=\"smartindex-error\">SmartIndex error: {$config->error}</div>";
} else {
    $seeker = new PageSeeker($config);
    $data = $seeker->get($config);

    $indexBuilder = new SmartIndexRenderer($config);
    $indexBuilder->setWrapper(false);
    $indexBuilder->render($data, $res);
}

echo $res.$_SESSION['poch'];
