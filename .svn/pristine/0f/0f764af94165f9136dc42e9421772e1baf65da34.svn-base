function getParameterByName(url, name)
{
  name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
  var regexS = "[\\?&]" + name + "=([^&#]*)";
  var regex = new RegExp(regexS);
  var results = regex.exec(url);
  if(results == null)
    return "";
  else
    return decodeURIComponent(results[1].replace(/\+/g, " "));
}

jQuery(function(){
    jQuery('.smartindex-treeview li.namespace.closed > a').live('click', function(event){
        var link = jQuery(this);
        if (jQuery(this).siblings("ul").length == 0) {
            jQuery.get('lib/plugins/smartindex/ajax.php', {namespace: getParameterByName(link.attr('href'), 'idx')}, function(data){
                link.parent().append(data);
            });
        }
        
        jQuery(this).parent().removeClass('closed').addClass('open');
        return false;
    });
    
    jQuery('.smartindex-treeview li.namespace.open > a').live('click', function(event){
        jQuery(this).parent().removeClass('open').addClass('closed');
        return false;
    });
    
    jQuery('.smartindex-treeview li.page > a').bind('contextmenu', function(){
        alert('context');
        return false;
    });
    
    jQuery('.smartindex-treeview li.namespace > a').live('contextmenu', function(){
        jQuery(this).parent('li').find('li.open').removeClass('open').addClass('closed');
        jQuery(this).parent('li').removeClass('open').addClass('closed');
        return false;
    });
    
    jQuery('.smartindex-treeview').bind('contextmenu', function(){
        alert('context 3');
        return false;
    });
});
